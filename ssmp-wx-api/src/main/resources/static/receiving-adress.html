<!DOCTYPE html>
<html>
<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type"/>
    <meta content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" id="viewport"
          name="viewport">
    <meta content="telephone=no" name="format-detection"/>
    <base th:href="${#request.getContextPath()}+'/'">
    <link href="css/ydui.css" rel="stylesheet" type="text/css"/>
    <link href="css/demo.css" rel="stylesheet" type="text/css"/>
    <link href="css/reset.css" rel="stylesheet" type="text/css">
    <link href="css/receiving-adress.css" rel="stylesheet" type="text/css">
    <script src="js/ydui.flexible.js"></script>
</head>
<body>
<div class="near-box">
    <div class="header">
        <a class="left" href="javascript:history.go(-1)"></a>
        收货地址
    </div>
    <div class="bigbox">
        <div class="receiv-text1">地址信息</div>
        <div class="receiv-box1"><input class="receiv-input1" id="realName" placeholder="收货人姓名（请使用真实姓名）" type="text">
        </div>
        <div class="receiv-box1"><input class="receiv-input1" id="mobile" placeholder="手机号码" type="number"></div>
        <div class="delivery-layer-box">
            <div class="cell-item">
                <div class="cell-right cell-arrow">
                    <input class="cell-input" id="J_Address" placeholder="请选择收货地址" readonly type="text">
                </div>
            </div>
        </div>
        <div class="receiv-box2"><textarea class="receiv-input2" id="address2" placeholder="详细地址"></textarea></div>
        <button class="set-text1">保存</button>
    </div>

</div>
<script src="js/jquery-1.8.3.min.js" type="text/javascript"></script>
<script src="js/ydui.citys.js" type="text/javascript"></script>
<script src="js/ydui.js" type="text/javascript"></script>
<script src="js/core.util.js" type="text/javascript"></script>
<script src="js/mlayer.min.js" type="text/javascript"></script>
<script type="text/javascript">
    /**
     * 默认调用
     */
    !function () {
        var $target = $('#J_Address');

        $target.citySelect();

        $target.on('click', function (event) {
            event.stopPropagation();
            $target.citySelect('open');
        });

        $target.on('done.ydui.cityselect', function (ret) {
            $(this).val(ret.provance + ' ' + ret.city + ' ' + ret.area);
        });
    }();

    $(function () {
        var memberId = CoreUtil.getQueryVariable("memberId");

        $(".set-text1").click(function () {
            var realName = $("#realName").val();
            if (CoreUtil.isEmpty(realName, '收货人不能为空')) {
                return;
            }
            var mobile = $("#mobile").val();
            if (CoreUtil.isEmpty(mobile, '收货人不能为空')) {
                return;
            }
            var address1 = $("#J_Address").val();
            if (CoreUtil.isEmpty(address1, '收货地址不能为空')) {
                return;
            }
            var address2 = $("#address2").val();
            if (CoreUtil.isEmpty(address2, '详细地址不能为空')) {
                return;
            }
            var address = address1 + address2;
            CoreUtil.sendPost("/api/user/addMemberAddress", {
                "memberId": memberId,
                "realName": realName,
                "address": address,
                "mobile": mobile
            }, function (res) {
                if (res.code == 200) {
                    history.go(-1)
                } else {
                    mlayer.error({
                        title: res.msg,
                        time: 3
                    });
                }
            });
        });

    });
</script>
</body>
</html>